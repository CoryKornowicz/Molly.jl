<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Molly.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Molly.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../docs/">Documentation</a></li><li><a class="tocitem" href="../differentiable/">Differentiable simulation</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/Molly.jl/blob/master/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Molly-API"><a class="docs-heading-anchor" href="#Molly-API">Molly API</a><a id="Molly-API-1"></a><a class="docs-heading-anchor-permalink" href="#Molly-API" title="Permalink"></a></h1><p>The API reference can be found here.</p><p>Molly also re-exports <a href="https://github.com/JuliaArrays/StaticArrays.jl">StaticArrays.jl</a>, <a href="https://github.com/PainterQubits/Unitful.jl">Unitful.jl</a> and <a href="https://github.com/JuliaMolSim/AtomsBase.jl">AtomsBase.jl</a>, making the likes of <code>SVector</code> and <code>1.0u&quot;nm&quot;</code> available when you call <code>using Molly</code>.</p><p>The <a href="#Molly.visualize"><code>visualize</code></a> function is only available once you have called <code>using GLMakie</code>. <a href="https://github.com/JuliaPackaging/Requires.jl">Requires.jl</a> is used to lazily load this code when <a href="https://github.com/JuliaPlots/Makie.jl">GLMakie.jl</a> is available, which reduces the dependencies of the package.</p><ul><li><a href="#Molly.AbstractNeighborFinder"><code>Molly.AbstractNeighborFinder</code></a></li><li><a href="#Molly.AndersenThermostat"><code>Molly.AndersenThermostat</code></a></li><li><a href="#Molly.Atom"><code>Molly.Atom</code></a></li><li><a href="#Molly.AtomData"><code>Molly.AtomData</code></a></li><li><a href="#Molly.BerendsenThermostat"><code>Molly.BerendsenThermostat</code></a></li><li><a href="#Molly.CellListMapNeighborFinder"><code>Molly.CellListMapNeighborFinder</code></a></li><li><a href="#Molly.CoordinateLogger"><code>Molly.CoordinateLogger</code></a></li><li><a href="#Molly.Coulomb"><code>Molly.Coulomb</code></a></li><li><a href="#Molly.CoulombReactionField"><code>Molly.CoulombReactionField</code></a></li><li><a href="#Molly.DistanceCutoff"><code>Molly.DistanceCutoff</code></a></li><li><a href="#Molly.DistanceNeighborFinder"><code>Molly.DistanceNeighborFinder</code></a></li><li><a href="#Molly.DistanceVecNeighborFinder"><code>Molly.DistanceVecNeighborFinder</code></a></li><li><a href="#Molly.GeneralInteraction"><code>Molly.GeneralInteraction</code></a></li><li><a href="#Molly.Gravity"><code>Molly.Gravity</code></a></li><li><a href="#Molly.HarmonicAngle"><code>Molly.HarmonicAngle</code></a></li><li><a href="#Molly.HarmonicBond"><code>Molly.HarmonicBond</code></a></li><li><a href="#Molly.Interaction"><code>Molly.Interaction</code></a></li><li><a href="#Molly.InteractionList2Atoms"><code>Molly.InteractionList2Atoms</code></a></li><li><a href="#Molly.InteractionList3Atoms"><code>Molly.InteractionList3Atoms</code></a></li><li><a href="#Molly.InteractionList4Atoms"><code>Molly.InteractionList4Atoms</code></a></li><li><a href="#Molly.KineticEnergyLogger"><code>Molly.KineticEnergyLogger</code></a></li><li><a href="#Molly.LennardJones"><code>Molly.LennardJones</code></a></li><li><a href="#Molly.Mie"><code>Molly.Mie</code></a></li><li><a href="#Molly.NeighborList"><code>Molly.NeighborList</code></a></li><li><a href="#Molly.NeighborListVec"><code>Molly.NeighborListVec</code></a></li><li><a href="#Molly.NoCoupling"><code>Molly.NoCoupling</code></a></li><li><a href="#Molly.NoCutoff"><code>Molly.NoCutoff</code></a></li><li><a href="#Molly.NoNeighborFinder"><code>Molly.NoNeighborFinder</code></a></li><li><a href="#Molly.OpenMMAtomType"><code>Molly.OpenMMAtomType</code></a></li><li><a href="#Molly.OpenMMForceField"><code>Molly.OpenMMForceField</code></a></li><li><a href="#Molly.PeriodicTorsion"><code>Molly.PeriodicTorsion</code></a></li><li><a href="#Molly.PeriodicTorsionType"><code>Molly.PeriodicTorsionType</code></a></li><li><a href="#Molly.PotentialEnergyLogger"><code>Molly.PotentialEnergyLogger</code></a></li><li><a href="#Molly.RBTorsion"><code>Molly.RBTorsion</code></a></li><li><a href="#Molly.RescaleThermostat"><code>Molly.RescaleThermostat</code></a></li><li><a href="#Molly.ShiftedForceCutoff"><code>Molly.ShiftedForceCutoff</code></a></li><li><a href="#Molly.ShiftedPotentialCutoff"><code>Molly.ShiftedPotentialCutoff</code></a></li><li><a href="#Molly.SoftSphere"><code>Molly.SoftSphere</code></a></li><li><a href="#Molly.SpecificForce2Atoms"><code>Molly.SpecificForce2Atoms</code></a></li><li><a href="#Molly.SpecificForce3Atoms"><code>Molly.SpecificForce3Atoms</code></a></li><li><a href="#Molly.SpecificForce4Atoms"><code>Molly.SpecificForce4Atoms</code></a></li><li><a href="#Molly.SpecificInteraction"><code>Molly.SpecificInteraction</code></a></li><li><a href="#Molly.StormerVerlet"><code>Molly.StormerVerlet</code></a></li><li><a href="#Molly.StructureWriter"><code>Molly.StructureWriter</code></a></li><li><a href="#Molly.System-Tuple{AbstractString, OpenMMForceField}"><code>Molly.System</code></a></li><li><a href="#Molly.System"><code>Molly.System</code></a></li><li><a href="#Molly.TemperatureLogger"><code>Molly.TemperatureLogger</code></a></li><li><a href="#Molly.TotalEnergyLogger"><code>Molly.TotalEnergyLogger</code></a></li><li><a href="#Molly.TreeNeighborFinder"><code>Molly.TreeNeighborFinder</code></a></li><li><a href="#Molly.VelocityLogger"><code>Molly.VelocityLogger</code></a></li><li><a href="#Molly.VelocityVerlet"><code>Molly.VelocityVerlet</code></a></li><li><a href="#AtomsBase.velocity-Tuple{Any, Any}"><code>AtomsBase.velocity</code></a></li><li><a href="#Molly.accelerations"><code>Molly.accelerations</code></a></li><li><a href="#Molly.apply_coupling!-Tuple{System, Any, NoCoupling}"><code>Molly.apply_coupling!</code></a></li><li><a href="#Molly.displacements-Tuple{Any, Any}"><code>Molly.displacements</code></a></li><li><a href="#Molly.distances-Tuple{Any, Any}"><code>Molly.distances</code></a></li><li><a href="#Molly.find_neighbors"><code>Molly.find_neighbors</code></a></li><li><a href="#Molly.find_neighbors"><code>Molly.find_neighbors</code></a></li><li><a href="#Molly.force"><code>Molly.force</code></a></li><li><a href="#Molly.forces"><code>Molly.forces</code></a></li><li><a href="#Molly.kinetic_energy-Tuple{Any}"><code>Molly.kinetic_energy</code></a></li><li><a href="#Molly.log_property!"><code>Molly.log_property!</code></a></li><li><a href="#Molly.mass-Tuple{Atom}"><code>Molly.mass</code></a></li><li><a href="#Molly.maxwell_boltzmann-Tuple{Any, Any}"><code>Molly.maxwell_boltzmann</code></a></li><li><a href="#Molly.place_atoms-Tuple{Integer, Any, Any}"><code>Molly.place_atoms</code></a></li><li><a href="#Molly.place_diatomics-Tuple{Integer, Any, Any, Any}"><code>Molly.place_diatomics</code></a></li><li><a href="#Molly.potential_energy"><code>Molly.potential_energy</code></a></li><li><a href="#Molly.random_velocities!-Tuple{System, Any}"><code>Molly.random_velocities!</code></a></li><li><a href="#Molly.rdf-Tuple{Any, Any}"><code>Molly.rdf</code></a></li><li><a href="#Molly.run_loggers!"><code>Molly.run_loggers!</code></a></li><li><a href="#Molly.simulate!-Union{Tuple{S}, Tuple{D}, Tuple{System{D, S, false}, VelocityVerlet, Integer}} where {D, S}"><code>Molly.simulate!</code></a></li><li><a href="#Molly.temperature-Tuple{Any}"><code>Molly.temperature</code></a></li><li><a href="#Molly.total_energy"><code>Molly.total_energy</code></a></li><li><a href="#Molly.ustrip_vec-Tuple{Any}"><code>Molly.ustrip_vec</code></a></li><li><a href="#Molly.vector-Tuple{Any, Any, Any}"><code>Molly.vector</code></a></li><li><a href="#Molly.vector1D-Tuple{Any, Any, Any}"><code>Molly.vector1D</code></a></li><li><a href="#Molly.velocity_autocorr"><code>Molly.velocity_autocorr</code></a></li><li><a href="#Molly.visualize"><code>Molly.visualize</code></a></li><li><a href="#Molly.wrap_coords-Tuple{Any, Any}"><code>Molly.wrap_coords</code></a></li><li><a href="#Molly.wrap_coords_vec-Tuple{Any, Any}"><code>Molly.wrap_coords_vec</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="Molly.AbstractNeighborFinder" href="#Molly.AbstractNeighborFinder"><code>Molly.AbstractNeighborFinder</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A way to find near atoms to save on simulation time. Custom neighbor finders should sub-type this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L35-L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.AndersenThermostat" href="#Molly.AndersenThermostat"><code>Molly.AndersenThermostat</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AndersenThermostat(temperature, coupling_const)</code></pre><p>Rescale random velocities according to the Andersen thermostat.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/coupling.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Atom" href="#Molly.Atom"><code>Molly.Atom</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Atom(; &lt;keyword arguments&gt;)</code></pre><p>An atom and its associated information. Properties unused in the simulation or in analysis can be left with their default values. The types used should be bits types if the GPU is going to be used.</p><p><strong>Arguments</strong></p><ul><li><code>index::Int</code>: the index of the atom in the system.</li><li><code>charge::C=0.0</code>: the charge of the atom, used for electrostatic interactions.</li><li><code>mass::M=0.0u&quot;u&quot;</code>: the mass of the atom.</li><li><code>σ::S=0.0u&quot;nm&quot;</code>: the Lennard-Jones finite distance at which the inter-particle   potential is zero.</li><li><code>ϵ::E=0.0u&quot;kJ * mol^-1&quot;</code>: the Lennard-Jones depth of the potential well.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L84-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.AtomData" href="#Molly.AtomData"><code>Molly.AtomData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AtomData(atom_type, atom_name, res_number, res_name)</code></pre><p>Data associated with an atom. Storing this separately allows the atom types to be bits types and hence work on the GPU.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L131-L137">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.BerendsenThermostat" href="#Molly.BerendsenThermostat"><code>Molly.BerendsenThermostat</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">BerendsenThermostat(temperature, coupling_const)</code></pre><p>The Berendsen thermostat. This thermostat should not be used in general as it can lead to simulation artifacts.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/coupling.jl#L60-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.CellListMapNeighborFinder" href="#Molly.CellListMapNeighborFinder"><code>Molly.CellListMapNeighborFinder</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">CellListMapNeighborFinder(; nb_matrix, matrix_14, n_steps, dist_cutoff, x0, unit_cell)</code></pre><p>Find close atoms by distance, and store auxiliary arrays for in-place threading. <code>x0</code> and <code>unit_cell</code>  are optional initial coordinates and system unit cell that improve the first approximation of the cell list structure. The unit cell can be provided as a three-component vector of box sides on each direction, in which case the unit cell is considered <code>OrthorhombicCell</code>, or as a unit cell matrix, in which case the cell is considered a general <code>TriclinicCell</code> by the cell list algorithm.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl">julia&gt; coords
15954-element Vector{SVector{3, Quantity{Float64, 𝐋, Unitful.FreeUnits{(nm,), 𝐋, nothing}}}}:
 [2.5193063341012127 nm, 3.907448346081021 nm, 4.694954671434135 nm]
 [2.4173958848835233 nm, 3.916034913604175 nm, 4.699661024574953 nm]
 ⋮
 [1.818842280373283 nm, 5.592152965227421 nm, 4.992100424805031 nm]
 [1.7261366568663976 nm, 5.610326185704369 nm, 5.084523386833478 nm]

julia&gt; box_size
3-element SVector{3, Quantity{Float64, 𝐋, Unitful.FreeUnits{(nm,), 𝐋, nothing}}} with indices SOneTo(3):
              5.676 nm
             5.6627 nm
             6.2963 nm

julia&gt; neighbor_finder = CellListMapNeighborFinder(
           nb_matrix=s.neighbor_finder.nb_matrix, matrix_14=s.neighbor_finder.matrix_14, 
           n_steps=10, dist_cutoff=1.2u&quot;nm&quot;,
           x0 = coords, unit_cell = box_size
       )
CellListMapNeighborFinder{Quantity{Float64, 𝐋, Unitful.FreeUnits{(nm,), 𝐋, nothing}}, 3, Float64}
  Size of nb_matrix = (15954, 15954)
  n_steps = 10
  dist_cutoff = 1.2 nm
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/neighbors.jl#L279-L316">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.CoordinateLogger" href="#Molly.CoordinateLogger"><code>Molly.CoordinateLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">CoordinateLogger(n_steps; dims=3)</code></pre><p>Log the coordinates throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/loggers.jl#L58-L62">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Coulomb" href="#Molly.Coulomb"><code>Molly.Coulomb</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Coulomb(; cutoff, nl_only, weight_14, coulomb_const, force_units, energy_units)</code></pre><p>The Coulomb electrostatic interaction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/interactions/coulomb.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.CoulombReactionField" href="#Molly.CoulombReactionField"><code>Molly.CoulombReactionField</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">CoulombReactionField(; dist_cutoff, solvent_dielectric, nl_only, weight_14,
                        coulomb_const, force_units, energy_units)</code></pre><p>The Coulomb electrostatic interaction modified using the reaction field approximation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/interactions/coulomb_reaction_field.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.DistanceCutoff" href="#Molly.DistanceCutoff"><code>Molly.DistanceCutoff</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DistanceCutoff(dist_cutoff)</code></pre><p>Cutoff that sets the potential and force to be zero past a specified cutoff point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/cutoffs.jl#L18-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.DistanceNeighborFinder" href="#Molly.DistanceNeighborFinder"><code>Molly.DistanceNeighborFinder</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DistanceNeighborFinder(; nb_matrix, matrix_14, n_steps, dist_cutoff)</code></pre><p>Find close atoms by distance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/neighbors.jl#L36-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.DistanceVecNeighborFinder" href="#Molly.DistanceVecNeighborFinder"><code>Molly.DistanceVecNeighborFinder</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DistanceVecNeighborFinder(; nb_matrix, matrix_14, n_steps, dist_cutoff)</code></pre><p>Find close atoms by distance in a GPU and differentiable safe manner.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/neighbors.jl#L108-L112">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.GeneralInteraction" href="#Molly.GeneralInteraction"><code>Molly.GeneralInteraction</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A general interaction that will apply to all or most atom pairs. Custom general interactions should sub-type this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L23-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Gravity" href="#Molly.Gravity"><code>Molly.Gravity</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Gravity(; G, nl_only)</code></pre><p>The gravitational interaction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/interactions/gravity.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.HarmonicAngle" href="#Molly.HarmonicAngle"><code>Molly.HarmonicAngle</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">HarmonicAngle(; th0, cth)</code></pre><p>A harmonic bond angle between three atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/interactions/harmonic_angle.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.HarmonicBond" href="#Molly.HarmonicBond"><code>Molly.HarmonicBond</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">HarmonicBond(; b0, kb)</code></pre><p>A harmonic bond between two atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/interactions/harmonic_bond.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Interaction" href="#Molly.Interaction"><code>Molly.Interaction</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An interaction between atoms that contributes to forces on the atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.InteractionList2Atoms" href="#Molly.InteractionList2Atoms"><code>Molly.InteractionList2Atoms</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">InteractionList2Atoms(is, js, inters)
InteractionList2Atoms(inter_type)</code></pre><p>A list of specific interactions between two atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L41-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.InteractionList3Atoms" href="#Molly.InteractionList3Atoms"><code>Molly.InteractionList3Atoms</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">InteractionList3Atoms(is, js, ks, inters)
InteractionList3Atoms(inter_type)</code></pre><p>A list of specific interactions between three atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L53-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.InteractionList4Atoms" href="#Molly.InteractionList4Atoms"><code>Molly.InteractionList4Atoms</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">InteractionList4Atoms(is, js, ks, ls, inters)
InteractionList4Atoms(inter_type)</code></pre><p>A list of specific interactions between four atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L66-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.KineticEnergyLogger" href="#Molly.KineticEnergyLogger"><code>Molly.KineticEnergyLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">KineticEnergyLogger(n_steps)</code></pre><p>Log the kinetic energy of the system throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/loggers.jl#L147-L151">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.LennardJones" href="#Molly.LennardJones"><code>Molly.LennardJones</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">LennardJones(; cutoff, nl_only, lorentz_mixing, weight_14, force_units, energy_units, skip_shortcut)</code></pre><p>The Lennard-Jones 6-12 interaction. The potential is given by</p><p class="math-container">\[V_{ij}(r_{ij}) = 4\varepsilon_{ij} \left[\left(\frac{\sigma_{ij}}{r_{ij}}\right)^{12} - \left(\frac{\sigma_{ij}}{r_{ij}}\right)^{6}\right]\]</p><p>and the force on each atom by</p><p class="math-container">\[\begin{aligned}
\vec{F}_i &amp;= 24\varepsilon_{ij} \left(2\frac{\sigma_{ij}^{12}}{r_{ij}^{13}} - \frac{\sigma_{ij}^6}{r_{ij}^{7}}\right) \frac{\vec{r}_{ij}}{r_{ij}} \\
&amp;= \frac{24\varepsilon_{ij}}{r_{ij}^2} \left[2\left(\frac{\sigma_{ij}^{6}}{r_{ij}^{6}}\right)^2 -\left(\frac{\sigma_{ij}}{r_{ij}}\right)^{6}\right] \vec{r}_{ij}
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/interactions/lennard_jones.jl#L3-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Mie" href="#Molly.Mie"><code>Molly.Mie</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Mie(; m, n, cutoff, nl_only, lorentz_mixing, force_units, energy_units, skip_shortcut)</code></pre><p>The Mie generalized interaction. When <code>m</code> equals 6 and <code>n</code> equals 12 this is equivalent to the Lennard-Jones interaction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/interactions/mie.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.NeighborList" href="#Molly.NeighborList"><code>Molly.NeighborList</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">NeighborList()
NeighborList(n, list)</code></pre><p>Structure to contain pre-allocated neighbor lists.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L155-L160">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.NeighborListVec" href="#Molly.NeighborListVec"><code>Molly.NeighborListVec</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">NeighborListVec(n, list)</code></pre><p>Structure to contain neighbor lists for broadcasting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L192-L196">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.NoCoupling" href="#Molly.NoCoupling"><code>Molly.NoCoupling</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">NoCoupling()</code></pre><p>Placeholder coupler that does nothing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/coupling.jl#L10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.NoCutoff" href="#Molly.NoCutoff"><code>Molly.NoCutoff</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">NoCutoff()</code></pre><p>Placeholder cutoff that does not alter forces or potentials.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/cutoffs.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.NoNeighborFinder" href="#Molly.NoNeighborFinder"><code>Molly.NoNeighborFinder</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">NoNeighborFinder()</code></pre><p>Placeholder neighbor finder that returns no neighbors. When using this neighbor finder, ensure that <code>nl_only</code> for the interactions is set to <code>false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/neighbors.jl#L11-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.OpenMMAtomType" href="#Molly.OpenMMAtomType"><code>Molly.OpenMMAtomType</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">OpenMMAtomType(class, element, mass, σ, ϵ)</code></pre><p>An OpenMM atom type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/setup.jl#L72-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.OpenMMForceField" href="#Molly.OpenMMForceField"><code>Molly.OpenMMForceField</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">OpenMMForceField(ff_files...)
OpenMMForceField(T, ff_files...)
OpenMMForceField(atom_types, residue_types, bond_types, angle_types,
                    torsion_types, torsion_order, weight_14_coulomb,
                    weight_14_lj)</code></pre><p>An OpenMM force field. Read one or more OpenMM force field XML files by passing them to the constructor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/setup.jl#L109-L119">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.PeriodicTorsion" href="#Molly.PeriodicTorsion"><code>Molly.PeriodicTorsion</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">PeriodicTorsion(; periodicities, phases, ks)</code></pre><p>A periodic torsion angle between four atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/interactions/periodic_torsion.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.PeriodicTorsionType" href="#Molly.PeriodicTorsionType"><code>Molly.PeriodicTorsionType</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">PeriodicTorsionType(proper, periodicities, phases, ks)</code></pre><p>A periodic torsion type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/setup.jl#L97-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.PotentialEnergyLogger" href="#Molly.PotentialEnergyLogger"><code>Molly.PotentialEnergyLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">PotentialEnergyLogger(n_steps)</code></pre><p>Log the potential energy of the system throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/loggers.jl#L174-L178">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.RBTorsion" href="#Molly.RBTorsion"><code>Molly.RBTorsion</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">RBTorsion(; f1, f2, f3, f4)</code></pre><p>A Ryckaert-Bellemans torsion angle between four atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/interactions/rb_torsion.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.RescaleThermostat" href="#Molly.RescaleThermostat"><code>Molly.RescaleThermostat</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">RescaleThermostat(temperature)</code></pre><p>The velocity rescaling thermostat. This thermostat should not be used in general as it can lead to simulation artifacts.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/coupling.jl#L45-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.ShiftedForceCutoff" href="#Molly.ShiftedForceCutoff"><code>Molly.ShiftedForceCutoff</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ShiftedForceCutoff(dist_cutoff)</code></pre><p>Cutoff that shifts the force to be continuous at a specified cutoff point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/cutoffs.jl#L52-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.ShiftedPotentialCutoff" href="#Molly.ShiftedPotentialCutoff"><code>Molly.ShiftedPotentialCutoff</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ShiftedPotentialCutoff(dist_cutoff)</code></pre><p>Cutoff that shifts the potential to be continuous at a specified cutoff point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/cutoffs.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.SoftSphere" href="#Molly.SoftSphere"><code>Molly.SoftSphere</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SoftSphere(; cutoff, nl_only, lorentz_mixing, force_units, energy_units, skip_shortcut)</code></pre><p>The soft-sphere potential.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/interactions/soft_sphere.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.SpecificForce2Atoms" href="#Molly.SpecificForce2Atoms"><code>Molly.SpecificForce2Atoms</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SpecificForce2Atoms(f1, f2)</code></pre><p>Forces on two atoms arising from an interaction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/force.jl#L107-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.SpecificForce3Atoms" href="#Molly.SpecificForce3Atoms"><code>Molly.SpecificForce3Atoms</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SpecificForce3Atoms(f1, f2, f3)</code></pre><p>Forces on three atoms arising from an interaction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/force.jl#L117-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.SpecificForce4Atoms" href="#Molly.SpecificForce4Atoms"><code>Molly.SpecificForce4Atoms</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SpecificForce4Atoms(f1, f2, f3, f4)</code></pre><p>Forces on four atoms arising from an interaction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/force.jl#L128-L132">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.SpecificInteraction" href="#Molly.SpecificInteraction"><code>Molly.SpecificInteraction</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A specific interaction between sets of specific atoms, e.g. a bond angle. Custom specific interactions should sub-type this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L29-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.StormerVerlet" href="#Molly.StormerVerlet"><code>Molly.StormerVerlet</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">StormerVerlet(; &lt;keyword arguments&gt;)</code></pre><p>The Störmer-Verlet integrator. In this case the <code>velocities</code> given to the simulator act as the previous step coordinates for the first step. Does not currently work with units or thermostats.</p><p><strong>Arguments</strong></p><ul><li><code>dt::T</code>: the time step of the simulation.</li><li><code>coupling::C=NoCoupling()</code>: the coupling which applies during the simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/simulators.jl#L35-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.StructureWriter" href="#Molly.StructureWriter"><code>Molly.StructureWriter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">StructureWriter(n_steps, filepath, excluded_res=String[])</code></pre><p>Write 3D output structures to the PDB file format throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/loggers.jl#L201-L205">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.System" href="#Molly.System"><code>Molly.System</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">System(; &lt;keyword arguments&gt;)</code></pre><p>A physical system to be simulated. Properties unused in the simulation or in analysis can be left with their default values. <code>atoms</code>, <code>atoms_data</code>, <code>coords</code> and <code>velocities</code> should have the same length. This is a sub-type of <code>AbstractSystem</code> from AtomsBase.jl and implements the interface described there.</p><p><strong>Arguments</strong></p><ul><li><code>atoms::A</code>: the atoms, or atom equivalents, in the system. Can be   of any type but should be a bits type if the GPU is used.</li><li><code>atoms_data::AD</code>: other data associated with the atoms, allowing the atoms to   be bits types and hence work on the GPU.</li><li><code>general_inters::GI=()</code>: the general interactions in the system, i.e.   interactions between all or most atoms such as electrostatics. Typically a   <code>Tuple</code>.</li><li><code>specific_inter_lists::SI=()</code>: the specific interactions in the system,   i.e. interactions between specific atoms such as bonds or angles. Typically   a <code>Tuple</code>.</li><li><code>coords::C</code>: the coordinates of the atoms in the system. Typically a   vector of <code>SVector</code>s of 2 or 3 dimensions.</li><li><code>velocities::V=zero(coords)</code>: the velocities of the atoms in the system.</li><li><code>box_size::B</code>: the size of the box in which the simulation takes place.   Typically a <code>SVector</code> of 2 or 3 dimensions.</li><li><code>neighbor_finder::NF=NoNeighborFinder()</code>: the neighbor finder used to find   close atoms and save on computation.</li><li><code>loggers::L=Dict()</code>: the loggers that record properties of interest during a   simulation.</li><li><code>force_units::F=u&quot;kJ * mol^-1 * nm^-1&quot;</code>: the units of force of the system.</li><li><code>energy_units::E=u&quot;kJ * mol^-1&quot;</code>: the units of energy of the system.</li><li><code>gpu_diff_safe::Bool</code>: whether to use the code path suitable for the   GPU and taking gradients. Defaults to <code>isa(coords, CuArray)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L206-L240">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.System-Tuple{AbstractString, OpenMMForceField}" href="#Molly.System-Tuple{AbstractString, OpenMMForceField}"><code>Molly.System</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">System(coordinate_file, force_field; &lt;keyword arguments&gt;)</code></pre><p>Read a coordinate file in a file format readable by Chemfiles and apply a force field to it.</p><pre><code class="language-none">System(coordinate_file, topology_file; &lt;keyword arguments&gt;)
System(T, coordinate_file, topology_file; &lt;keyword arguments&gt;)</code></pre><p>Read a Gromacs coordinate file and a Gromacs topology file with all includes collapsed into one file.</p><p><strong>Arguments</strong></p><ul><li><code>velocities=nothing</code>: the velocities of the atoms in the system, set to   zero by default.</li><li><code>loggers=Dict()</code>: the loggers that record properties of interest during a   simulation.</li><li><code>units::Bool=true</code>: whether to use Unitful quantities.</li><li><code>gpu::Bool=false</code>: whether to move the relevant parts of the system onto   the GPU.</li><li><code>gpu_diff_safe::Bool</code>: whether to use the code path suitable for the   GPU and taking gradients, defaults to the value of <code>gpu</code>.</li><li><code>dist_cutoff=1.0u&quot;nm&quot;</code>: cutoff distance for long-range interactions.</li><li><code>nl_dist=1.2u&quot;nm&quot;</code>: cutoff distance for neighbor list, should not be less   than <code>dist_cutoff</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/setup.jl#L269-L294">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.TemperatureLogger" href="#Molly.TemperatureLogger"><code>Molly.TemperatureLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">TemperatureLogger(n_steps)
TemperatureLogger(T, n_steps)</code></pre><p>Log the temperature throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/loggers.jl#L25-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.TotalEnergyLogger" href="#Molly.TotalEnergyLogger"><code>Molly.TotalEnergyLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">TotalEnergyLogger(n_steps)</code></pre><p>Log the total energy of the system throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/loggers.jl#L120-L124">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.TreeNeighborFinder" href="#Molly.TreeNeighborFinder"><code>Molly.TreeNeighborFinder</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">TreeNeighborFinder(; nb_matrix, matrix_14, n_steps, dist_cutoff)</code></pre><p>Find close atoms by distance using a tree search.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/neighbors.jl#L203-L207">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.VelocityLogger" href="#Molly.VelocityLogger"><code>Molly.VelocityLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">VelocityLogger(n_steps; dims=3)</code></pre><p>Log the velocities throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/loggers.jl#L89-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.VelocityVerlet" href="#Molly.VelocityVerlet"><code>Molly.VelocityVerlet</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">VelocityVerlet(; &lt;keyword arguments&gt;)</code></pre><p>The velocity Verlet integrator.</p><p><strong>Arguments</strong></p><ul><li><code>dt::T</code>: the time step of the simulation.</li><li><code>coupling::C=NoCoupling()</code>: the coupling which applies during the simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/simulators.jl#L19-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AtomsBase.velocity-Tuple{Any, Any}" href="#AtomsBase.velocity-Tuple{Any, Any}"><code>AtomsBase.velocity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">velocity(mass, temperature; dims=3)</code></pre><p>Generate a random velocity from the Maxwell-Boltzmann distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/spatial.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.accelerations" href="#Molly.accelerations"><code>Molly.accelerations</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">accelerations(system, neighbors=nothing; parallel=true)</code></pre><p>Calculate the accelerations of all atoms using the general and specific interactions and Newton&#39;s second law.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/force.jl#L89-L94">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.apply_coupling!-Tuple{System, Any, NoCoupling}" href="#Molly.apply_coupling!-Tuple{System, Any, NoCoupling}"><code>Molly.apply_coupling!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">apply_coupling!(system, simulator, coupling)</code></pre><p>Apply a coupler to modify a simulation. Custom couplers should implement this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/coupling.jl#L17-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.displacements-Tuple{Any, Any}" href="#Molly.displacements-Tuple{Any, Any}"><code>Molly.displacements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">displacements(coords, box_size)</code></pre><p>Get the pairwise vector displacements of a set of coordinates, accounting for the periodic boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/analysis.jl#L36-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.distances-Tuple{Any, Any}" href="#Molly.distances-Tuple{Any, Any}"><code>Molly.distances</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">distances(coords, box_size)</code></pre><p>Get the pairwise distances of a set of coordinates, accounting for the periodic boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/analysis.jl#L49-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.find_neighbors" href="#Molly.find_neighbors"><code>Molly.find_neighbors</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">find_neighbors(s::System,
                nf::CellListMapNeighborFinder,
                current_neighbors=nothing,
                step_n::Integer=0;
                parallel::Bool=true)</code></pre><p>Find neighbors using <code>CellListMap</code>, without in-place updating. Should be called only the first time the cell lists are built. Modifies the mutable <code>nf</code> structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/neighbors.jl#L386-L395">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.find_neighbors" href="#Molly.find_neighbors"><code>Molly.find_neighbors</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">find_neighbors(system, neighbor_finder, current_neighbors=nothing, step_n=0; parallel=true)</code></pre><p>Obtain a list of close atoms in a system. Custom neighbor finders should implement this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/neighbors.jl#L20-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.force" href="#Molly.force"><code>Molly.force</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">force(inter, coord_i, coord_j, atom_i, atom_j, box_size)</code></pre><p>Calculate the force between a pair of atoms due to a given interation type. Custom interaction types should implement this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/force.jl#L27-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.forces" href="#Molly.forces"><code>Molly.forces</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">forces(system, neighbors=nothing; parallel=true)</code></pre><p>Calculate the forces on all atoms using the general and specific interactions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/force.jl#L186-L190">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.kinetic_energy-Tuple{Any}" href="#Molly.kinetic_energy-Tuple{Any}"><code>Molly.kinetic_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">kinetic_energy(s)</code></pre><p>Compute the kinetic energy of the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/energy.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.log_property!" href="#Molly.log_property!"><code>Molly.log_property!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">log_property!(logger, system, neighbors=nothing, step_n=0)</code></pre><p>Log a property of the system thoughout a simulation. Custom loggers should implement this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/loggers.jl#L46-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.mass-Tuple{Atom}" href="#Molly.mass-Tuple{Atom}"><code>Molly.mass</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">mass(atom)</code></pre><p>The mass of an atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/types.jl#L117-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.maxwell_boltzmann-Tuple{Any, Any}" href="#Molly.maxwell_boltzmann-Tuple{Any, Any}"><code>Molly.maxwell_boltzmann</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">maxwell_boltzmann(mass, temperature)</code></pre><p>Generate a random speed along one dimension from the Maxwell-Boltzmann distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/spatial.jl#L83-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.place_atoms-Tuple{Integer, Any, Any}" href="#Molly.place_atoms-Tuple{Integer, Any, Any}"><code>Molly.place_atoms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">place_atoms(n_atoms, box_size, min_dist)</code></pre><p>Obtain <code>n_atoms</code> 3D coordinates in a box with sides <code>box_size</code> where no two points are closer than <code>min_dist</code>, accounting for periodic boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/setup.jl#L13-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.place_diatomics-Tuple{Integer, Any, Any, Any}" href="#Molly.place_diatomics-Tuple{Integer, Any, Any, Any}"><code>Molly.place_diatomics</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">place_diatomics(n_molecules, box_size, min_dist, bond_length)</code></pre><p>Obtain 3D coordinates for <code>n_molecules</code> diatomics in a box with sides <code>box_size</code> where no two points are closer than <code>min_dist</code> and the bond length is <code>bond_length</code>, accounting for periodic boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/setup.jl#L40-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.potential_energy" href="#Molly.potential_energy"><code>Molly.potential_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">potential_energy(s, neighbors=nothing)</code></pre><p>Compute the potential energy of the system. If the interactions use neighbor lists, the neighbors should be computed first and passed to the function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/energy.jl#L46-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.random_velocities!-Tuple{System, Any}" href="#Molly.random_velocities!-Tuple{System, Any}"><code>Molly.random_velocities!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">random_velocities!(sys, temp)</code></pre><p>Set the velocities of a <code>System</code> to random velocities generated from the Maxwell-Boltzmann distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/spatial.jl#L95-L100">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.rdf-Tuple{Any, Any}" href="#Molly.rdf-Tuple{Any, Any}"><code>Molly.rdf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">rdf(coords, box_size; npoints=200)</code></pre><p>Get the radial distribution function of a set of coordinates. This describes how density varies as a function of distance from each atom. Returns a list of distance bin centres and a list of the corresponding densities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/analysis.jl#L57-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.run_loggers!" href="#Molly.run_loggers!"><code>Molly.run_loggers!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">run_loggers!(system, neighbors=nothing, step_n=0)</code></pre><p>Run the loggers associated with the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/loggers.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.simulate!-Union{Tuple{S}, Tuple{D}, Tuple{System{D, S, false}, VelocityVerlet, Integer}} where {D, S}" href="#Molly.simulate!-Union{Tuple{S}, Tuple{D}, Tuple{System{D, S, false}, VelocityVerlet, Integer}} where {D, S}"><code>Molly.simulate!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">simulate!(system, simulator, n_steps; parallel=true)
simulate!(system, simulator; parallel=true)</code></pre><p>Run a simulation on a system according to the rules of the given simulator. Custom simulators should implement this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/simulators.jl#L54-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.temperature-Tuple{Any}" href="#Molly.temperature-Tuple{Any}"><code>Molly.temperature</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">temperature(system)</code></pre><p>Calculate the temperature of a system from the kinetic energy of the atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/energy.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.total_energy" href="#Molly.total_energy"><code>Molly.total_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">total_energy(s, neighbors=nothing)</code></pre><p>Compute the total energy of the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/energy.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.ustrip_vec-Tuple{Any}" href="#Molly.ustrip_vec-Tuple{Any}"><code>Molly.ustrip_vec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">ustrip_vec(x)</code></pre><p>Broadcasted form of <code>ustrip</code> from Unitful.jl, allowing e.g. <code>ustrip_vec.(coords)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/force.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.vector-Tuple{Any, Any, Any}" href="#Molly.vector-Tuple{Any, Any, Any}"><code>Molly.vector</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">vector(c1, c2, box_size)</code></pre><p>Displacement between two coordinate values from c1 to c2, accounting for the bounding box. The minimum image convention is used, so the displacement is to the closest version of the coordinates accounting for the periodic boundaries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/spatial.jl#L27-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.vector1D-Tuple{Any, Any, Any}" href="#Molly.vector1D-Tuple{Any, Any, Any}"><code>Molly.vector1D</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">vector1D(c1, c2, side_length)</code></pre><p>Displacement between two 1D coordinate values from c1 to c2, accounting for the bounding box. The minimum image convention is used, so the displacement is to the closest version of the coordinate accounting for the periodic boundaries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/spatial.jl#L11-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.velocity_autocorr" href="#Molly.velocity_autocorr"><code>Molly.velocity_autocorr</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">velocity_autocorr(vl, first_ind, last_ind)</code></pre><p>Calculates the autocorrelation function of velocity from the velocity logger.  This helps characterize the similarity between velocities observed at different time instances.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/analysis.jl#L83-L89">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.visualize" href="#Molly.visualize"><code>Molly.visualize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">visualize(coord_logger, box_size, out_filepath; &lt;keyword arguments&gt;)</code></pre><p>Visualize a simulation as an animation. This function is only available when GLMakie is imported. It can take a while to run, depending on the length and size of the simulation.</p><p><strong>Arguments</strong></p><ul><li><code>connections=Tuple{Int, Int}[]</code>: pairs of atoms indices to link with bonds.</li><li><code>connection_frames</code>: the frames in which bonds are shown. Is a list of the   same length as the number of frames, where each item is a list of <code>Bool</code>s of   the same length as <code>connections</code>. Defaults to always <code>true</code>.</li><li><code>trails::Integer=0</code>: the number of preceding frames to show as transparent   trails.</li><li><code>framerate::Integer=30</code>: the frame rate of the animation.</li><li><code>color=:purple</code>: the color of the atoms. Can be a single color or a list of   colors of the same length as the number of atoms.</li><li><code>connection_color=:orange</code>: the color of the bonds. Can be a single color or a   list of colors of the same length as <code>connections</code>.</li><li><code>markersize=20.0</code>: the size of the atom markers.</li><li><code>linewidth=2.0</code>: the width of the bond lines.</li><li><code>transparency=true</code>: whether transparency is active on the plot.</li><li><code>kwargs...</code>: other keyword arguments are passed to the plotting function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/analysis.jl#L10-L33">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.wrap_coords-Tuple{Any, Any}" href="#Molly.wrap_coords-Tuple{Any, Any}"><code>Molly.wrap_coords</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">wrap_coords(c, side_length)</code></pre><p>Ensure a 1D coordinate is within the simulation box and return the coordinate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/spatial.jl#L60-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.wrap_coords_vec-Tuple{Any, Any}" href="#Molly.wrap_coords_vec-Tuple{Any, Any}"><code>Molly.wrap_coords_vec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">wrap_coords_vec(c, box_size)</code></pre><p>Ensure a coordinate is within the simulation box and return the coordinate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/ec74875569b40e28125f944025cf9992a46dc7f0/src/spatial.jl#L67-L71">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 12 January 2022 16:03">Wednesday 12 January 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
